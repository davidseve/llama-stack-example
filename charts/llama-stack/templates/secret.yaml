apiVersion: v1
kind: Secret
metadata:
  annotations:
    openshift.io/display-name: {{ .Values.global.name }}
  name: {{ .Values.global.name }}-secret
  namespace: {{ .Values.global.namespace }}
  labels:
    {{- include "llama-stack.labels" . | nindent 4 }}
stringData:
  # vLLM API Tokens (dynamically generated from providers.vllm)
  {{- range $name, $vllm := .Values.providers.vllm }}
  {{- $tokenKey := $vllm.apiTokenSecret | default "VLLM_API_TOKEN" }}
  {{- $tokenValue := index $.Values.secret.data $tokenKey }}
  {{- if $tokenValue }}
  {{ $tokenKey }}: {{ $tokenValue | quote }}
  {{- end }}
  {{- end }}
  # vLLM Embedding API Tokens (dynamically generated from providers.vllmEmbedding)
  {{- range $name, $embed := .Values.providers.vllmEmbedding }}
  {{- $tokenKey := $embed.apiTokenSecret | default "VLLM_API_TOKEN" }}
  {{- $tokenValue := index $.Values.secret.data $tokenKey }}
  {{- if $tokenValue }}
  {{ $tokenKey }}: {{ $tokenValue | quote }}
  {{- end }}
  {{- end }}
  # AWS/Bedrock credentials
  {{- if .Values.secret.data.AWS_ACCESS_KEY_ID }}
  AWS_ACCESS_KEY_ID: {{ .Values.secret.data.AWS_ACCESS_KEY_ID | quote }}
  {{- end }}
  {{- if .Values.secret.data.AWS_SECRET_ACCESS_KEY }}
  AWS_SECRET_ACCESS_KEY: {{ .Values.secret.data.AWS_SECRET_ACCESS_KEY | quote }}
  {{- end }}
  {{- if .Values.secret.data.AWS_SESSION_TOKEN }}
  AWS_SESSION_TOKEN: {{ .Values.secret.data.AWS_SESSION_TOKEN | quote }}
  {{- end }}
  # WatsonX API Key
  {{- if .Values.secret.data.WATSONX_API_KEY }}
  WATSONX_API_KEY: {{ .Values.secret.data.WATSONX_API_KEY | quote }}
  {{- end }}
  # Azure API Key
  {{- if .Values.secret.data.AZURE_API_KEY }}
  AZURE_API_KEY: {{ .Values.secret.data.AZURE_API_KEY | quote }}
  {{- end }}
  # OpenAI API Key
  {{- if .Values.secret.data.OPENAI_API_KEY }}
  OPENAI_API_KEY: {{ .Values.secret.data.OPENAI_API_KEY | quote }}
  {{- end }}
  # Milvus Token
  {{- if .Values.secret.data.MILVUS_TOKEN }}
  MILVUS_TOKEN: {{ .Values.secret.data.MILVUS_TOKEN | quote }}
  {{- end }}
  # FAISS KVStore Password
  {{- if .Values.secret.data.FAISS_KVSTORE_PASSWORD }}
  FAISS_KVSTORE_PASSWORD: {{ .Values.secret.data.FAISS_KVSTORE_PASSWORD | quote }}
  {{- end }}
  # Brave Search API Key
  {{- if .Values.secret.data.BRAVE_SEARCH_API_KEY }}
  BRAVE_SEARCH_API_KEY: {{ .Values.secret.data.BRAVE_SEARCH_API_KEY | quote }}
  {{- end }}
  # Tavily Search API Key
  {{- if .Values.secret.data.TAVILY_SEARCH_API_KEY }}
  TAVILY_SEARCH_API_KEY: {{ .Values.secret.data.TAVILY_SEARCH_API_KEY | quote }}
  {{- end }}
  # Kubeflow Pipelines Token
  {{- if .Values.secret.data.KUBEFLOW_PIPELINES_TOKEN }}
  KUBEFLOW_PIPELINES_TOKEN: {{ .Values.secret.data.KUBEFLOW_PIPELINES_TOKEN | quote }}
  {{- end }}
